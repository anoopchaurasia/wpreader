fm.Package("com.reader.article"),fm.Import("com.reader.source.Sources"),fm.Import("com.reader.setting.Settings"),fm.Import("lib.FillContent"),fm.Class("ArticleController","jfm.dom.Controller"),com.reader.article.ArticleController=function(e,t,n,r,i,s){"use strict";function u(e){var t=jQuery(window).width(),n=e*a;return Math.min(t-40,n)}function l(e){function d(){var t=o+30;if(a[1]<=0){v(1,p),n.append('<br style="clear:both" />');return}p++;var r;n.width(p*(s+40)),r=$(l).appendTo(n),r.find("div.s").height(c-t-10).width(s),a=h.truncateWithHeight(r.find("div.s"),a[0],e),f=setTimeout(d,10)}e="<h1 class='title'>"+t.article.title+"</h1>"+e;var n=$("#articleContainer").empty(),s=u(r.getInstance().fontSize),o=0;n.parent().css("fontSize",r.getInstance().fontSize);var a=[0,1],l="<div class='parent selector'><div class='s'></div></div>";clearTimeout(f);var c=window.innerHeight-n.offset().top-10,h=new i,p=0;d()}function h(e){var t;e=$(e),$(document).off("keydown swiperight swipeleft swipeup swipedown").on("keydown swiperight swipeleft swipeup swipedown",function(n,r){var i=e.find(".selector");t=t&&t.filter(":visible").length&&t||i.eq(0);var s=!1,o=c[n.type]||n.keyCode;switch(o){case 37:t.prev().length&&(t.removeClass("selected"),t=t.prev(),s=!0);break;case 39:t.next().length&&t.next()[0].nodeName!=="BR"&&(t.removeClass("selected"),t=t.next(),s=!0)}s&&(v(t.index()+1),t.addClass("selected"),p(t,e))})}function p(e,t){t=t.parent();var n=t.scrollLeft(),r=n+t.width(),i=e[0].offsetLeft-t[0].offsetLeft,s=i+e.width()+10;i<n?t.animate({scrollLeft:i}):s>r&&t.animate({scrollLeft:s-t.width()})}function v(e,t){d=t===undefined?d:t,$(document).trigger("page_info",{colNumber:e,totalCol:d})}this.setMe=function(e){t=e};var o;this.onStart=function(e,i){n.getInstance().getArticles(parseInt(e.sourceId),function(n){t.article=n.getById(parseInt(e.articleId)),i(),o=r.getInstance().on("fontSize,color_class,window-resize",function(){l(t.article.content)})})},this.afterRender=function(){l(t.article.content),h(t.articleContainer)},this.onStop=function(){o&&o(),v(0,0),clearTimeout(f),$("#settingPopup").remove()},this.ArticleController=function(e){$(window).scrollTop(0)};var a=18,f,c={swiperight:37,swipeleft:39,swipeup:39,swipedown:37},d};
fm.isMinified=true;
