fm.Package("jfm.dom"),fm.Import("jfm.dom.DomManager"),fm.Import("jfm.dom.ListView"),fm.AbstractClass("Controller","jfm.dom.ChangeListener"),jfm.dom.Controller=function(e,t,n,r,i){"use strict";function o(e){return typeof e=="string"&&(e=jQuery("<div>"+jQuery.trim(e)+"</div>").contents()[0]),u([e]),e}function u(e){var t,n,r,i=[];i=e;for(var s=0,o=i.length;s<o;s++){n=i[s].attributes;var a={};switch(i[s].nodeType){case 1:for(var f=0;f<n.length;f++)r=n[f],r.specified&&(a[directiveNormalize(r.name)]=$.trim(r.value),l(directiveNormalize(r.name),a[directiveNormalize(r.name)],i[s]));u(i[s].childNodes)}}}function f(e,t,n,r){var i=t.split(".");for(var s=0;s<i.length-1;s++)e=e[i[s]];return e[i[s]]=r!==undefined?r:n,[e,i[s]]}function l(e,t,n){if(a[e]){var r=$(n).data("actionObj");r||$(n).data("actionObj",r={}),r[e]=a[e](t,n)}}function c(e,t){for(var n in e){if(typeof e[n]=="object")return c(e[n],t[n]);if(e[n]!==t[n])return!1}return!0}this.setMe=function(e){t=e};var s={};this.Controller=function(){e()},Static.setTemplate=function(e,t){var e=o(e);s[t]=e},this.createDom=function(e,r){this.getTemplate(e,function(e){r&&r(new n(e,t.getSub()))})},Static.getTemplate=function(e,n){s[e]?n($(s[e]).clone(!0)):ReadFile.isPhone?ReadFile.get(e,function(r){t.setTemplate(r,e),n($(s[e]).clone(!0))}):jQuery.get(e,function(r){t.setTemplate(r,e),n($(s[e]).clone(!0))})};var a={fmClick:function(e){return e=parser(e),function(t,n){$(t).on("click",function(){e(n)})}},fmName:function(e){var t=parser(e)({});return function(n,r){r[t||e]=$(n)}},fmStyle:function(e){var t=parser("{"+e+"}");return function(e,n){var r;n.on("change",function(i){var s=t(n);!c(s,r)&&$(e).css(r=s)}),r=t(n),$(e).css(r)}},fmHide:function(e){var t=parser(e);return function(e,n){n.on("change",function(i){var s=t(n);s!==r&&((r=s)?$(e).css("display","none"):$(e).css("display",""))});var r=t(n);r?$(e).css("display","none"):$(e).css("display","")}},fmShow:function(e){var t=parser(e);return function(e,n){n.on("change",function(i){var s=t(n);s!==r&&((r=s)?$(e).css("display",""):$(e).css("display","none"))});var r=t(n);r?$(e).css("display",""):$(e).css("display","none")}},fmSrc:function(e){var t=/(.*?){{(.*?)}}/g.exec(e);return e=parser(t[2]),function(n,r){r.on("change",function(s){var o=e(r);i!==o&&(n.src=t[1]+(i=o))});var i=e(r);n.src=t[1]+i}},fmHref:function(e){var t=/(.*?){{(.*?)}}/g.exec(e);return e=parser(t[2]),function(n,r){r.on("change",function(s){var o=e(r);i!==o&&(n.href=t[1]+(i=o))});var i=e(r);n.href=t[1]+i}},fmBind:function(e){return e=parser(e),function(t,n){n.on("change",function(i){var s=e(n);r!==s&&(t.innerHTML=r=s)});var r=e(n);t.innerHTML=r}},fmChecked:function(e){var t=parser(e);return function(e,n){e.checked=t(n)}},fmRepeat:function(e,t){e=e.split("|");var n=e[0].match(/^\s*(.+)\s+in\s+(.*)\s*$/),i=parser(n[2]),s=$(t).data("actionObj");return function(t,o){var u=i(o),f=e[1]&&e[1].match(/(.*?):(.*?)$/);f&&(s.show=a.fmShow(f[2]));var l=u.instancOf&&u.instancOf(r)?u:new r(u);o["$"+n[2]]=l;var c=$.extend({},s);delete c.fmRepeat;var h=$(t).clone(!0).hide();return $(t).after(h).remove(),h.data("actionObj",c),setTimeout(function(){l.createView(h,o,n[1])},30),!1}},fmValue:function(e){var t=parser(e);return function(t,n){$(t).change(function(){var t=f(n,e,this.value,this.checked);n.domchange&&n.domchange(t[0],t[1])})}},fmDirective:function(e){return e=parser(e.replace("(","(element")),function(t,n){n.element=t,e(n)}}}};
fm.isMinified=true;
